# Modal 顯示選項功能實作計劃

## 📋 功能概述

為精油詳細資訊 Modal 新增使用者自定義顯示選項，讓使用者可以根據自己的需求選擇要查看的資訊區塊，提升使用體驗並減少資訊過載。

## 🎯 目標

- 讓使用者自由選擇要在 Modal 中顯示的資訊區塊
- 記憶使用者的顯示偏好設定
- 提供快速切換和重置功能
- 保持介面簡潔易用

## 📊 複雜度評估

**整體複雜度：中等** ⭐⭐⭐☆☆

### 技術挑戰
- ✅ UI 開關元件實作（簡單）
- ✅ localStorage 儲存讀取（簡單）
- ✅ 條件渲染邏輯（簡單）
- ⚡ 設定面板 UI 設計（中等）
- ⚡ 動畫過渡效果（中等）
- ⚡ 響應式設計調整（中等）

**預估開發時間：2-3 小時**

## 🏗️ 現有架構分析

### 目前 Modal 資訊結構

#### 1. 基本資訊（必須顯示）
- 產品名稱（中英文）
- 產品圖片
- 價格資訊（建議售價、會員價）
- 產品規格（容量、編號、PV點數）
- 類別標籤
- 系列標籤

#### 2. 可選顯示區塊
| 區塊名稱 | 內容說明 | 預設顯示 |
|---------|---------|---------|
| 精油介紹 | 產品詳細介紹文字 | ✅ |
| 主要功效 | 功效列表 | ✅ |
| 香味特色 | 香氛描述 | ✅ |
| 精油資訊 | 萃取方法、萃取部位 | ✅ |
| 主要成分 | 化學成分列表 | ✅ |
| 使用方法 | 使用說明列表 | ✅ |
| 注意事項 | 安全警告和注意事項 | ✅ |

## 💡 實作方案比較

### 方案一：設定面板模式（推薦）⭐⭐⭐⭐⭐

**特點**：
- 在 Modal 右上角加入設定按鈕（齒輪圖示）
- 點擊展開設定面板，包含各區塊的開關
- 使用 localStorage 儲存偏好
- 即時套用設定變更

**優點**：
- ✅ 實作簡單直覺
- ✅ 不影響主要閱讀體驗
- ✅ 設定一次，永久生效
- ✅ 易於維護和擴展

**缺點**：
- ❌ 需要額外的 UI 空間
- ❌ 使用者可能不易發現功能

### 方案二：標籤頁模式 ⭐⭐⭐⭐☆

**特點**：
- 將資訊分成不同標籤頁
- 基本資訊、功效、使用方法等分頁顯示
- 記憶最後查看的標籤

**優點**：
- ✅ 資訊分類清楚
- ✅ 減少單頁資訊量
- ✅ 切換方便

**缺點**：
- ❌ 無法同時查看多個區塊
- ❌ 需要更多點擊操作
- ❌ 改變現有使用習慣

### 方案三：摺疊面板模式 ⭐⭐⭐☆☆

**特點**：
- 每個區塊都可展開/收合
- 使用者自由控制查看內容
- 記憶展開狀態

**優點**：
- ✅ 靈活性高
- ✅ 可同時查看多個區塊
- ✅ 視覺反饋清楚

**缺點**：
- ❌ 操作較繁瑣
- ❌ 可能造成頁面過長
- ❌ 動畫效能考量

## 🚀 建議實作方案詳細規劃

### 採用方案一：設定面板模式

#### 1. 建立設定狀態管理

**新增檔案：`src/hooks/useModalSettings.ts`**

```typescript
interface ModalDisplaySettings {
  showIntroduction: boolean      // 精油介紹
  showBenefits: boolean          // 主要功效
  showAroma: boolean             // 香味特色
  showExtraction: boolean        // 精油資訊
  showIngredients: boolean       // 主要成分
  showUsage: boolean             // 使用方法
  showCautions: boolean          // 注意事項
}

// 預設全部顯示
const DEFAULT_SETTINGS: ModalDisplaySettings = {
  showIntroduction: true,
  showBenefits: true,
  showAroma: true,
  showExtraction: true,
  showIngredients: true,
  showUsage: true,
  showCautions: true
}
```

**功能包含**：
- 讀取 localStorage 設定
- 儲存設定到 localStorage
- 提供重置功能
- 匯出設定狀態和更新方法

#### 2. 建立設定面板元件

**新增檔案：`src/components/ModalSettingsPanel.tsx`**

**UI 設計**：
```
┌─────────────────────────────────┐
│ 顯示設定                     ✕  │
├─────────────────────────────────┤
│ □ 精油介紹                      │
│ □ 主要功效                      │
│ □ 香味特色                      │
│ □ 精油資訊                      │
│ □ 主要成分                      │
│ □ 使用方法                      │
│ □ 注意事項                      │
├─────────────────────────────────┤
│ [全選] [全不選] [重置為預設]    │
└─────────────────────────────────┘
```

**功能特點**：
- 使用 Checkbox 控制各區塊顯示
- 提供快速操作按鈕
- 即時預覽效果
- 動畫過渡效果

#### 3. 整合到 OilDetailModal

**修改檔案：`src/components/OilDetailModal.tsx`**

**新增功能**：
1. 引入 useModalSettings Hook
2. 在右上角加入設定按鈕
3. 條件渲染各資訊區塊
4. 加入 Transition 動畫

**UI 位置規劃**：
```
┌──────────────────────────────────┐
│ [關閉] [收藏] [設定⚙]           │
│                                  │
│        Modal 內容區              │
│                                  │
└──────────────────────────────────┘
```

## 📝 實作步驟清單

### Phase 1：基礎架構（1小時）
- [ ] 建立 useModalSettings Hook
- [ ] 實作 localStorage 讀寫邏輯
- [ ] 建立設定資料結構
- [ ] 撰寫單元測試

### Phase 2：UI 元件（1小時）
- [ ] 建立 ModalSettingsPanel 元件
- [ ] 設計設定面板 UI
- [ ] 實作開關控制邏輯
- [ ] 加入快速操作按鈕

### Phase 3：整合實作（30分鐘）
- [ ] 修改 OilDetailModal 元件
- [ ] 加入設定按鈕
- [ ] 實作條件渲染
- [ ] 測試各種組合

### Phase 4：優化提升（30分鐘）
- [ ] 加入過渡動畫
- [ ] 優化響應式設計
- [ ] 效能測試和優化
- [ ] 使用者體驗微調

## 🎨 UI/UX 設計考量

### 視覺設計
- 設定按鈕使用齒輪圖示 ⚙️
- 設定面板使用 Popover 或小型 Modal
- 保持與現有設計風格一致
- 使用 Tailwind CSS 樣式

### 互動設計
- 設定變更即時生效
- 提供視覺反饋（如勾選動畫）
- 關閉設定面板自動儲存
- 支援鍵盤操作（ESC 關閉）

### 響應式設計
- 手機版：設定面板全螢幕顯示
- 平板版：設定面板浮動顯示
- 桌面版：設定面板側邊顯示

## 🔧 技術實作細節

### 狀態管理
```typescript
// 使用 React Context 或直接使用 Hook
const { settings, updateSetting, resetSettings } = useModalSettings()

// 條件渲染範例
{settings.showBenefits && oil.mainBenefits && (
  <div className="mb-6">
    <h3>主要功效</h3>
    {/* 功效內容 */}
  </div>
)}
```

### localStorage 結構
```json
{
  "doterra-modal-settings": {
    "showIntroduction": true,
    "showBenefits": true,
    "showAroma": false,
    "showExtraction": true,
    "showIngredients": false,
    "showUsage": true,
    "showCautions": true,
    "lastUpdated": "2025-01-13T10:00:00Z"
  }
}
```

### 動畫效果
```css
/* 使用 Tailwind 的 transition utilities */
transition-all duration-300 ease-in-out
```

## 🧪 測試計劃

### 功能測試
- [ ] 設定儲存和讀取
- [ ] 各區塊顯示/隱藏
- [ ] 快速操作按鈕
- [ ] 跨瀏覽器相容性

### 使用者體驗測試
- [ ] 設定按鈕易發現性
- [ ] 操作流暢度
- [ ] 視覺回饋清晰度
- [ ] 錯誤處理

### 效能測試
- [ ] localStorage 讀寫效能
- [ ] 動畫流暢度
- [ ] 記憶體使用

## 📈 未來擴展可能

### 進階功能
1. **預設配置集**
   - 簡潔模式（只顯示基本資訊）
   - 專業模式（顯示所有技術細節）
   - 快速瀏覽模式（重點資訊）

2. **個人化設定**
   - 不同類別產品的不同設定
   - 根據使用頻率自動調整

3. **匯出/匯入設定**
   - 分享設定給其他使用者
   - 備份和還原設定

### 資料分析
- 追蹤最常顯示/隱藏的區塊
- 了解使用者偏好
- 優化預設設定

## 🚨 風險評估

### 技術風險
- localStorage 可能被禁用（提供降級方案）
- 舊瀏覽器相容性（使用 polyfill）
- 效能影響（優化渲染邏輯）

### 使用者體驗風險
- 功能發現性低（加入引導提示）
- 誤操作（提供撤銷功能）
- 設定遺失（定期備份）

## 📌 總結

這個功能實作難度適中，能顯著提升使用者體驗。建議採用設定面板模式，因為它在實作簡單性和功能完整性之間取得了良好平衡。整個實作預計需要 2-3 小時，可以分階段進行，確保每個步驟都經過充分測試。

---

*文件建立日期：2025-01-13*
*版本：1.0.0*